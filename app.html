<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admissions NG ST Question Generator</title>
    <link href="https://fonts.googleapis.com/css2?family=Spectral:wght@300;400;600;700&family=DM+Mono:wght@400;500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>Question Generator</h1>
            <p class="subtitle">Admissions NG ST Exam System</p>
        </header>

        <!-- Tab Navigation -->
        <div class="tab-nav">
            <button class="tab-btn active" onclick="switchTab('generate')">Generate Questions</button>
            <button class="tab-btn" onclick="switchTab('papers')">Question Papers</button>
        </div>

        <!-- ============ GENERATE TAB ============ -->
        <div class="tab-content active" id="tab-generate">
            <div class="control-panel">
                <div class="form-grid">
                    <div class="form-group">
                        <label for="school">School</label>
                        <select id="school" onchange="updateConceptDropdown()">
                            <!-- Populated dynamically on DOMContentLoaded from schoolConfig -->
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="concept">Concept</label>
                        <select id="concept" onchange="updateDifficultyDropdown()">
                            <!-- Populated dynamically by updateConceptDropdown() -->
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="difficulty">Difficulty Level</label>
                        <select id="difficulty">
                            <!-- Populated dynamically by updateDifficultyDropdown() -->
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="count">Number of Questions</label>
                        <input type="number" id="count" min="1" max="50" value="12">
                    </div>
                </div>

                <div class="button-group">
                    <button onclick="generateQuestions()">Generate Questions</button>
                    <button class="secondary" onclick="downloadPDF()" id="downloadBtn" disabled>Download as PDF</button>
                </div>
            </div>

            <div class="output-container">
                <div class="output-header">
                    <div class="output-title">Generated Questions</div>
                    <div class="question-count" id="questionCount">0 Questions</div>
                </div>

                <!-- Select All + Add to Paper bar (visible when a paper is active) -->
                <div class="select-all-row" id="selectAllRow">
                    <input type="checkbox" class="question-checkbox" id="selectAllCheckbox" onchange="toggleSelectAll(this)">
                    <label for="selectAllCheckbox">Select All</label>
                </div>

                <div id="output">
                    <div class="placeholder">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                        </svg>
                        <p>Click "Generate Questions" to begin</p>
                    </div>
                </div>

                <!-- Add to Paper bar -->
                <div class="add-to-paper-bar" id="addToPaperBar">
                    <div class="info">
                        <span id="selectedCount">0</span> selected Â· Active paper: <strong id="activePaperLabel">None</strong>
                    </div>
                    <button class="add-to-paper-btn" onclick="addSelectedToPaper()">Add to Paper</button>
                </div>
            </div>
        </div>

        <!-- ============ PAPERS TAB ============ -->
        <div class="tab-content" id="tab-papers">
            <div class="control-panel">
                <div class="paper-builder-top">
                    <div class="form-group">
                        <label for="paperSchool">School</label>
                        <select id="paperSchool">
                            <!-- Populated dynamically -->
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="paperSetName">Set Name</label>
                        <input type="text" id="paperSetName" placeholder="e.g. A, B, C...">
                    </div>
                    <button onclick="createPaper()">Create Paper</button>
                </div>

                <!-- Paper chips list -->
                <div class="paper-list" id="paperList">
                    <!-- Paper chips rendered here -->
                </div>
            </div>

            <!-- Active Paper Contents -->
            <div class="active-paper-panel" id="activePaperPanel">
                <div class="no-paper-placeholder" id="noPaperPlaceholder">
                    <p>Create a question paper above, then generate questions and add them here.</p>
                </div>
                <div id="activePaperContents" style="display:none;">
                    <div class="active-paper-header">
                        <div class="active-paper-title" id="activePaperTitleDisplay"></div>
                        <div class="active-paper-stats" id="activePaperStats"></div>
                    </div>
                    <div id="paperProgressGrid"></div>
                    <div id="paperQuestionsContainer"></div>
                    <div class="paper-download-bar" id="paperDownloadBar">
                        <button onclick="downloadQuestionPaperPDF()">Download Question Paper PDF</button>
                        <button class="secondary" onclick="downloadAnswerKeyPDF()">Download Answer Key</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="script.js"></script>
</body>
</html>